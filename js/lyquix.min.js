var lqx=lqx||{settings:{logger:{enable:false,namespaces:["window","jQuery","lqx"]},tracking:{downloads:true,outbound:true,scrolldepth:true,photogallery:true,video:true},shadeColorPercent:{lighter:20,light:10,dark:-10,darker:-20},resizeThrottle:{duration:15},scrollThrottle:{duration:15},bodyScreenSize:{min:0,max:4,breakPoints:[320,640,960,1280,1600]},equalHeightRows:{refreshElems:false,onlyVisible:true,checkPageLoad:true},lyqBox:{albumLabel:"%1 of %2",alwaysShowNavOnTouchDevices:false,fadeDuration:500,fitImagesInViewport:true,maxWidth:1920,maxHeight:1920,positionFromTop:50,resizeDuration:700,showImageNumberLabel:true,wrapAround:true,disableScrolling:true}},vars:{resizeThrottle:false,scrollThrottle:false,bodyScreenSize:{sizes:["xs","sm","md","lg","xl"]}},setOptions:function(opts){if(typeof opts=="object"){jQuery.extend(true,lqx.settings,opts)}return lqx.settings},initLogging:function(){if(lqx.settings.logger.enable){for(var i in lqx.settings.logger.namespaces){lqx.addLoggingToNamespace(lqx.settings.logger.namespaces[i])}}},addLoggingToNamespace:function(nameSpace){if(nameSpace=="window"){namespaceObject=window}else{namespaceObject=window[nameSpace]}for(var name in namespaceObject){var potentialFunction=namespaceObject[name];if(Object.prototype.toString.call(potentialFunction)==="[object Function]"){namespaceObject[name]=lqx.getLoggableFunction(potentialFunction,name,nameSpace)}}},getLoggableFunction:function(func,name,nameSpace){return function(){console.log("LOG: executing "+nameSpace+"."+name+" with arguments:");console.log(arguments);return func.apply(this,arguments)}},bodyScreenSize:function(){var w=jQuery(window).width();if(w<lqx.settings.bodyScreenSize.breakPoints[1])s=0;if(w>=lqx.settings.bodyScreenSize.breakPoints[1])s=1;if(w>=lqx.settings.bodyScreenSize.breakPoints[2])s=2;if(w>=lqx.settings.bodyScreenSize.breakPoints[3])s=3;if(w>=lqx.settings.bodyScreenSize.breakPoints[4])s=4;if(lqx.vars.bodyScreenSize.sizes[s]!=lqx.vars.lastScreenSize){if(s<lqx.settings.bodyScreenSize.min)s=lqx.settings.bodyScreenSize.min;if(s>lqx.settings.bodyScreenSize.max)s=lqx.settings.bodyScreenSize.max;jQuery("body").attr("screen",lqx.vars.bodyScreenSize.sizes[s]);document.getElementsByTagName("body")[0].className=document.getElementsByTagName("body")[0].className;lqx.vars.lastScreenSize=lqx.vars.bodyScreenSize.sizes[s];jQuery(document).trigger("screensizechange")}},mobileDetect:function(){var md=new MobileDetect(window.navigator.userAgent);var r={mobile:false,phone:false,tablet:false};if(md.mobile()!=null){r.mobile=true;jQuery("body").addClass("mobile");if(md.phone()!=null){r.phone=true;jQuery("body").addClass("phone")}if(md.tablet()!=null){r.tablet=true;jQuery("body").addClass("tablet")}}return r},getBrowser:function(){var ua=navigator.userAgent,browser;function getFirstMatch(regex){var match=ua.match(regex);return match&&match.length>1&&match[1]||""}function getSecondMatch(regex){var match=ua.match(regex);return match&&match.length>1&&match[2]||""}if(/opera|opr/i.test(ua)){browser={name:"Opera",type:"opera",version:getFirstMatch(/version\/(\d+(\.\d+)?)/i)||getFirstMatch(/(?:opera|opr)[\s\/](\d+(\.\d+)?)/i)}}else if(/msie|trident/i.test(ua)){browser={name:"Internet Explorer",type:"msie",version:getFirstMatch(/(?:msie |rv:)(\d+(\.\d+)?)/i)}}else if(/chrome.+? edge/i.test(ua)){browser={name:"Microsft Edge",type:"msedge",version:getFirstMatch(/edge\/(\d+(\.\d+)?)/i)}}else if(/chrome|crios|crmo/i.test(ua)){browser={name:"Google Chrome",type:"chrome",version:getFirstMatch(/(?:chrome|crios|crmo)\/(\d+(\.\d+)?)/i)}}else if(/firefox/i.test(ua)){browser={name:"Firefox",type:"firefox",version:getFirstMatch(/(?:firefox)[ \/](\d+(\.\d+)?)/i)}}else if(!/like android/i.test(ua)&&/android/i.test(ua)){browser={name:"Android",type:"android",version:getFirstMatch(/version\/(\d+(\.\d+)?)/i)}}else if(/safari/i.test(ua)){browser={name:"Safari",type:"safari",version:getFirstMatch(/version\/(\d+(\.\d+)?)/i)}}else{browser={name:getFirstMatch(/^(.*)\/(.*) /),version:getSecondMatch(/^(.*)\/(.*) /)};browser.type=browser.name.toLowerCase().replace(/\s/g,"")}jQuery("body").addClass(browser.type);jQuery("body").addClass(browser.type+"-"+browser.version.split(".")[0]);jQuery("body").addClass(browser.type+"-"+browser.version.replace(/\./g,"-"));return browser},getOS:function(){var ua=navigator.userAgent,os;function getFirstMatch(regex){var match=ua.match(regex);return match&&match.length>1&&match[1]||""}function getSecondMatch(regex){var match=ua.match(regex);return match&&match.length>1&&match[2]||""}if(/(ipod|iphone|ipad)/i.test(ua)){os={name:"iOS",type:"ios",version:getFirstMatch(/os (\d+([_\s]\d+)*) like mac os x/i).replace(/[_\s]/g,".")}}else if(/windows phone/i.test(ua)){os={name:"Windows Phone",type:"windowsphone",version:getFirstMatch(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i)}}else if(!/like android/i.test(ua)&&/android/i.test(ua)){os={name:"Android",type:"android",version:getFirstMatch(/android[ \/-](\d+(\.\d+)*)/i)}}else if(/windows nt/i.test(ua)){os={name:"Windows",type:"windows",version:getFirstMatch(/windows nt (\d+(\.\d+)*)/i)}}else if(/mac os x/i.test(ua)){os={name:"Mac OS X",type:"macosx",version:getFirstMatch(/mac os x (\d+([_\s]\d+)*)/i).replace(/[_\s]/g,".")}}else if(/ubuntu/i.test(ua)){os={name:"Ubuntu",type:"ubuntu",version:getFirstMatch(/ubuntu\/(\d+(\.\d+)*)/i)}}else if(/fedora/i.test(ua)){os={name:"Fedora",type:"fedora",version:getFirstMatch(/fedora\/(\d+(\.\d+)*)/i)}}else if(/CrOS/.test(ua)){os={name:"Chrome OS",type:"chromeos",version:getSecondMatch(/cros (.+) (\d+(\.\d+)*)/i)}}if(os.type&&os.version){jQuery("body").addClass(os.type);jQuery("body").addClass(os.type+"-"+os.version.split(".")[0]);jQuery("body").addClass(os.type+"-"+os.version.replace(/\./g,"-"))}return os},browserFixes:function(){if(lqx.getBrowser.type=="msie"){jQuery("img").each(function(){var img=jQuery(this);if(img.attr("width")==undefined){var newimg=new Image;newimg.onload=function(){img.attr("width",newimg.width)};newimg.src=img.attr("src")}});if(lqx.getBrowser.version>=10){jQuery("html").css("font-feature-settings","normal")}if(lqx.getBrowser.version<=8){jQuery("img").each(function(){src=jQuery(this).attr("src");if(/\.svg$/i.test(src)){jQuery(this).attr("src",src.replace(".svg",".png"))}})}}},initEqualHeightRows:function(){if(lqx.settings.equalHeightRows.onlyVisible){lqx.vars.equalHeightRowElems=jQuery(".equalheightrow:visible")}else{lqx.vars.equalHeightRowElems=jQuery(".equalheightrow")}lqx.vars.equalHeightRowImgs=lqx.vars.equalHeightRowElems.find("img");lqx.vars.equalHeightRowPageLoaded=false;jQuery(window).load(function(){lqx.vars.equalHeightRowPageLoaded=true});lqx.equalHeightRows()},equalHeightRows:function(opts){var s=lqx.settings.equalHeightRows;if(typeof opts=="object")jQuery.extend(true,s,opts);if(s.refreshElems||typeof lqx.vars.equalHeightRowElems=="undefined"){if(lqx.settings.equalHeightRows.onlyVisible){lqx.vars.equalHeightRowElems=jQuery(".equalheightrow:visible")}else{lqx.vars.equalHeightRowElems=jQuery(".equalheightrow")}lqx.vars.equalHeightRowImgs=lqx.vars.equalHeightRowElems.find("img")}var elemsCount=lqx.vars.equalHeightRowElems.length;lqx.vars.equalHeightRowElems.height("auto").promise().done(function(){var currElem,currElemTop=0,currElemHeight=0,currRowElems=new Array,currRowTop=0,currRowHeight=0;lqx.vars.equalHeightRowElems.each(function(i){currElem=jQuery(this);currElemTop=currElem.offset().top;currElemHeight=currElem.height();if(currElemTop!=currRowTop){if(currRowElems.length>1){for(var j=0;j<currRowElems.length;j++){currRowElems[j].height(currRowHeight)}}currRowElems=new Array(currElem);currRowTop=currElem.offset().top;currRowHeight=currElemHeight}else{currRowElems.push(currElem);currRowHeight=currElemHeight>currRowHeight?currElemHeight:currRowHeight;if(i==elemsCount-1){if(currRowElems.length>1){for(var j=0;j<currRowElems.length;j++){currRowElems[j].height(currRowHeight)}}}}}).promise().done(function(){if(!(lqx.settings.equalHeightRows.checkPageLoad&&lqx.vars.equalHeightRowPageLoaded)){lqx.vars.equalHeightRowImgs.each(function(){if(this.complete!=true||typeof this.naturalWidth!=="undefined"&&this.naturalWidth===0){if(typeof jQuery(this).attr("loaderror")!="undefined"){setTimeout(function(){lqx.equalHeightRows(opts)},250)}}})}})})},hangingPunctuation:function(){lqx.vars.hangingMarks={"“":"medium","‘":"small",'"':"medium","'":"small","«":"large","‹":"medium","„":"medium","‚":"small"};jQuery(".hanging-punctuation").find("p").each(function(idx,elem){lqx.hangPunctuation(elem)})},hangPunctuation:function(elem){var plaintext=elem.innerText||elem.textContent;for(var mark in lqx.vars.hangingMarks){if(plaintext.indexOf(mark)===0){jQuery(elem).append('<span id="hangingMark">'+mark+"</span>");var w=jQuery("#hangingMark").outerWidth();jQuery(elem).css("text-indent","-"+w+"px");jQuery("#hangingMark").remove()}}},imageCaption:function(){jQuery(".image.caption img").each(function(idx,elem){var caption=jQuery(elem).attr("alt");if(caption){jQuery(elem).after('<div class="caption">'+caption+"</div>")}})},lineBreakSymbol:function(){jQuery(".show-line-break p br").each(function(idx,elem){jQuery(elem).before(String.fromCharCode(8626))})},shadeColor:function(){for(var i in["color","bg","border"]){for(var j in["lighter","light","dark","darker"]){var prop;switch(i){case"color":prop="color";break;case"bg":prop="background-color";break;case"border":prop="border-color";break}var c="."+i+"-"+j;jQuery(c).each(function(idx,elem){var color=jQuery(elem).css(prop);if(color.charAt(0)=="#"){color=shadeHex(color,lqx.settings.shadeColorPercent[j])}else{color=shadeRGB(color,lqx.settings.shadeColorPercent[j])}jQuery(elem).css(prop,color)})}}},shadeHex:function(color,percent){var num=parseInt(color.slice(1),16),amt=Math.round(2.55*percent),R=(num>>16)+amt,G=(num>>8&255)+amt,B=(num&255)+amt;return"#"+(16777216+(R<255?R<1?0:R:255)*65536+(G<255?G<1?0:G:255)*256+(B<255?B<1?0:B:255)).toString(16).slice(1)},shadeRGB:function(color,percent){var f=color.split(","),t=percent<0?0:255,p=percent<0?percent*-1:percent,R=parseInt(f[0].slice(4)),G=parseInt(f[1]),B=parseInt(f[2]);return"rgb("+(Math.round((t-R)*p)+R)+","+(Math.round((t-G)*p)+G)+","+(Math.round((t-B)*p)+B)+")"},initTracking:function(){if(typeof window.ga!=="undefined"){if(lqx.settings.tracking.outbound||lqx.settings.tracking.download){jQuery("a").each(function(){var elem=this;if(elem.href){if(typeof jQuery(this).attr("data-featherlight")==="undefined"&&typeof jQuery(this).parent().attr("data-featherlight-gallery")==="undefined"){if(elem.href.indexOf(location.host)==-1&&lqx.settings.tracking.outbound){jQuery(elem).click(function(e){e.preventDefault?e.preventDefault():e.returnValue=!1;var url=elem.href;var label=url;if(jQuery(elem).attr("title")){label=jQuery(elem).attr("title")+" ["+url+"]"}ga("send",{hitType:"event",eventCategory:"Outbound Links",eventAction:"click",eventLabel:label,nonInteraction:true,hitCallback:function(){window.location.href=url}})})}else if(elem.href.match(/\.(gif|png|jpg|jpeg|tif|tiff|svg|webp|bmp|zip|rar|gzip|7z|tar|exe|msi|dmg|txt|pdf|rtf|doc|docx|dot|dotx|xls|xlsx|xlt|xltx|ppt|pptx|pot|potx|mp3|wav|mp4|ogg|webm|wma|mov|avi|wmv|flv|swf|xml|js|json|css|less|sass)$/i)&&lqx.settings.tracking.downloads){jQuery(elem).click(function(e){e.preventDefault?e.preventDefault():e.returnValue=!1;var url=elem.href;var loc=elem.protocol+"//"+elem.hostname+elem.pathname+elem.search;var page=elem.pathname+elem.search;var title="Download: "+page;if(jQuery(elem).attr("title")){title=jQuery(elem).attr("title")}ga("send",{hitType:"pageview",location:loc,page:page,title:title,hitCallback:function(){window.location.href=url}})})}}}})}if(lqx.settings.tracking.scrolldepth){lqx.vars.scrollDepthMax=Math.ceil((jQuery(window).scrollTop()+jQuery(window).height())/jQuery(document).height()*10)*10;jQuery(window).on("scrollthrottle",function(){if(lqx.vars.scrollDepthMax<100){lqx.vars.scrollDepthMax=Math.max(lqx.vars.scrollDepthMax,Math.ceil((jQuery(window).scrollTop()+jQuery(window).height())/jQuery(document).height()*10)*10);if(lqx.vars.scrollDepthMax>100)lqx.vars.scrollDepthMax=100}});jQuery(window).on("unload",function(){ga("send",{hitType:"event",eventCategory:"Scroll Depth",eventAction:lqx.vars.scrollDepthMax,nonInteraction:true})})}if(lqx.settings.tracking.photogallery){jQuery("html").on("click","a[rel^=lightbox], area[rel^=lightbox], a[data-lightbox], area[data-lightbox], a[data-featherlight-image]",function(){ga("send",{hitType:"event",eventCategory:"Photo Gallery",eventAction:"Open"})});jQuery("html").on("load","img.lb-image",function(){ga("send",{hitType:"event",eventCategory:"Photo Gallery",eventAction:"Display",eventLabel:jQuery(this).attr("src")})})}if(lqx.settings.tracking.video){var tag=document.createElement("script");tag.src="https://www.youtube.com/iframe_api";var firstScriptTag=document.getElementsByTagName("script")[0];firstScriptTag.parentNode.insertBefore(tag,firstScriptTag);if(window.addEventListener){window.addEventListener("message",lqx.vimeoReceiveMessage,false)}else{window.attachEvent("onmessage",lqx.vimeoReceiveMessage,false)}lqx.vars.youtubePlayers={};lqx.vars.vimeoPlayers={};jQuery("iframe").each(function(){var elem=jQuery(this);lqx.initVideoPlayerAPI(elem)})}}},featherlightMutationHandler:function(mutRec){jQuery(mutRec.addedNodes).each(function(){var elem=jQuery(this);var src=elem.attr("src");if(typeof elem.prop("tagName")!=="undefined"&&elem.hasClass("featherlight-image")){var tag=elem.prop("tagName").toLowerCase();if(tag=="img"&&typeof src!="undefined"){ga("send",{hitType:"event",eventCategory:"Photo Gallery",eventAction:"Display",eventLabel:jQuery(this).attr("src")})}}})},videoPlayerMutationHandler:function(mutRec){jQuery(mutRec.addedNodes).each(function(){var elem=jQuery(this);if(typeof elem.prop("tagName")!=="undefined"){var tag=elem.prop("tagName").toLowerCase();if(tag=="iframe"){lqx.initVideoPlayerAPI(elem)}}})},initVideoPlayerAPI:function(elem){var src=elem.attr("src");var playerId=elem.attr("id");if(typeof src!="undefined"){if(src.indexOf("youtube.com/embed/")!=-1){if(typeof playerId=="undefined"){playerId="youtubePlayer"+Object.keys(lqx.vars.youtubePlayers).length;elem.attr("id",playerId)}if(src.indexOf("enablejsapi=1")==-1){var urlconn="&";if(src.indexOf("?")==-1){urlconn="?"}elem.attr("src",src+urlconn+"enablejsapi=1&version=3")}if(typeof lqx.vars.youtubePlayers[playerId]=="undefined"){lqx.vars.youtubePlayers[playerId]={};onYouTubeIframeAPIReady()}}if(src.indexOf("player.vimeo.com/video/")!=-1){if(typeof playerId=="undefined"){playerId="vimeoPlayer"+Object.keys(lqx.vars.vimeoPlayers).length;elem.attr("id",playerId)}if(src.indexOf("api=1")==-1){var urlconn="&";if(src.indexOf("?")==-1){urlconn="?"}elem.attr("src",src+urlconn+"api=1&player_id="+playerId)}if(typeof lqx.vars.vimeoPlayers[playerId]=="undefined"){lqx.vars.vimeoPlayers[playerId]={}}}}},youtubePlayerReady:function(e,playerId){if(jQuery("#"+playerId).length){if(typeof lqx.vars.youtubePlayers[playerId].playerObj.getPlayerState!="function"){}else{if(typeof lqx.vars.youtubePlayers[playerId].progress=="undefined"){lqx.vars.youtubePlayers[playerId].progress=0;lqx.vars.youtubePlayers[playerId].start=false;lqx.vars.youtubePlayers[playerId].complete=false;var videoData=lqx.vars.youtubePlayers[playerId].playerObj.getVideoData();lqx.vars.youtubePlayers[playerId].title=videoData["title"];lqx.vars.youtubePlayers[playerId].duration=lqx.vars.youtubePlayers[playerId].playerObj.getDuration();if(!lqx.vars.youtubePlayers[playerId].start)lqx.youtubePlayerStateChange(e,playerId)}}}else{delete lqx.vars.youtubePlayers[playerId]}},youtubePlayerStateChange:function(e,playerId){if(jQuery("#"+playerId).length){var label;if(lqx.vars.youtubePlayers[playerId].playerObj.getPlayerState()==0&&!lqx.vars.youtubePlayers[playerId].complete){label="Complete";lqx.vars.youtubePlayers[playerId].complete=true}if(lqx.vars.youtubePlayers[playerId].playerObj.getPlayerState()==1){lqx.vars.youtubePlayers[playerId].timer=setTimeout(function(){lqx.youtubePlayerStateChange(e,playerId)},1e3);if(!lqx.vars.youtubePlayers[playerId].start){label="Start";lqx.vars.youtubePlayers[playerId].start=true}else{currentTime=lqx.vars.youtubePlayers[playerId].playerObj.getCurrentTime();if(Math.ceil(Math.ceil(currentTime/lqx.vars.youtubePlayers[playerId].duration*100)/10)-1>lqx.vars.youtubePlayers[playerId].progress){lqx.vars.youtubePlayers[playerId].progress=Math.ceil(Math.ceil(currentTime/lqx.vars.youtubePlayers[playerId].duration*100)/10)-1;if(lqx.vars.youtubePlayers[playerId].progress!=10){label=lqx.vars.youtubePlayers[playerId].progress*10+"%"}else{clearTimeout(lqx.vars.youtubePlayers[playerId].timer)}}}}if(lqx.vars.youtubePlayers[playerId].playerObj.getPlayerState()==3){lqx.vars.youtubePlayers[playerId].timer=setTimeout(function(){lqx.youtubePlayerStateChange(e,playerId)},1e3)}if(label){lqx.videoTrackingEvent(playerId,label,lqx.vars.youtubePlayers[playerId].title,lqx.vars.youtubePlayers[playerId].progress*10)}}else{delete lqx.vars.youtubePlayers[playerId]}},vimeoReceiveMessage:function(e){if(/^https?:\/\/player.vimeo.com/.test(e.origin)){var data=JSON.parse(e.data);player=lqx.vars.vimeoPlayers[data.player_id];var label;switch(data.event){case"ready":player.progress=0;player.start=false;player.complete=false;lqx.vimeoSendMessage(data.player_id,e.origin,"addEventListener","play");lqx.vimeoSendMessage(data.player_id,e.origin,"addEventListener","finish");lqx.vimeoSendMessage(data.player_id,e.origin,"addEventListener","playProgress");break;case"play":if(!player.start){label="Start";player.start=true}break;case"playProgress":if(Math.ceil(Math.ceil(data.data.percent*100)/10)-1>player.progress){player.progress=Math.ceil(Math.ceil(data.data.percent*100)/10)-1;if(player.progress!=10){label=player.progress*10+"%"}}break;case"finish":if(!player.complete){label="Complete";player.complete=true}}if(label){lqx.videoTrackingEvent(data.player_id,label,"No title",player.progress*10)}}},vimeoSendMessage:function(playerId,origin,action,value){var data={method:action};if(value){data.value=value}document.getElementById(playerId).contentWindow.postMessage(JSON.stringify(data),origin)},videoTrackingEvent:function(playerId,label,title,value){ga("send",{hitType:"event",eventCategory:"Video",eventAction:label,eventLabel:title+" ("+jQuery("#"+playerId).attr("src").split("?")[0]+")",eventValue:value})},initMobileMenu:function(){jQuery("body").on("click",".horizontal ul.menu a, .vertical ul.menu a, .slide-out ul.menu a",function(e){e.preventDefault();lqx.mobileMenu(this)});jQuery("body").on("click",".horizontal, .vertical, .slide-out",function(e){e.stopPropagation()});jQuery("body").on("click",".slide-out .menu-control",function(){var elem=jQuery(this).parent();if(jQuery(elem).hasClass("open")){jQuery(elem).removeClass("open")}else{jQuery(elem).addClass("open")}});jQuery("body").click(function(){jQuery(".horizontal, .vertical, .slide-out").find("ul.menu li.open").removeClass("open");jQuery(".slide-out.open").removeClass("open")})},mobileMenu:function(elem){var li=jQuery(elem).parent();var url=elem.href;var target=elem.target&&!elem.target.match(/^_(self|parent|top)$/i)?elem.target:false;var go=function(){target?window.open(url,target):window.location.href=url};if(jQuery(li).hasClass("deeper")){if(jQuery(li).hasClass("open")){go()}else{jQuery(li).siblings("li.open").find("li.open").removeClass("open");jQuery(li).siblings("li.open").removeClass("open");jQuery(li).addClass("open")}}else{go()}},initMutationObserver:function(){var mo=window.MutationObserver||window.WebKitMutationObserver;if(typeof mo!=="undefined"){lqx.mutationObserver=new mo(lqx.mutationHandler);lqx.mutationObserver.observe(jQuery("html")[0],{childList:true,characterData:true,attributes:true,subtree:true})}else{if(lqx.settings.tracking.video){jQuery("html").on("DOMNodeInserted","iframe",function(e){lqx.initVideoPlayerAPI(jQuery(e.currentTarget))})}if(lqx.settings.tracking.photogallery){jQuery("html").on("DOMNodeInserted","img.featherlight-image",function(e){var src=jQuery(e.currentTarget).attr("src");if(typeof src!="undefined"){ga("send",{hitType:"event",eventCategory:"Photo Gallery",eventAction:"Display",eventLabel:src})}})}}},mutationHandler:function(mutRecs){mutRecs.forEach(function(mutRec){switch(mutRec.type){case"childList":if(mutRec.addedNodes.length>0){lqx.videoPlayerMutationHandler(mutRec);lqx.featherlightMutationHandler(mutRec)}break;case"attributes":break;case"characterData":break}})},initImgLoadAttr:function(){jQuery("body").on("load","img",function(){jQuery(this).attr("loadcomplete","")});jQuery("body").on("error","img",function(){jQuery(this).attr("loaderror","")})},lyqBox:{init:function(){if(jQuery("[data-lyqbox]").length){var self=this;this.album=[];this.currentImageIndex=void 0;this.enable();this.build();var alertPromise=this.alert(jQuery("[data-lyqbox-type=alert]"));alertPromise.always(function afterAlertCheck(){self.hash()})}},hash:function(){if(window.location.hash.substr(1)!=""){var contentData=window.location.hash.substr(1).split("_");if(jQuery("[data-lyqbox="+contentData[0]+"][data-lyqbox-alias="+contentData[1]+"]").length){this.start(jQuery("[data-lyqbox="+contentData[0]+"][data-lyqbox-alias="+contentData[1]+"]"))}else{}}},alert:function(alertbox){var self=this;var deferred=jQuery.Deferred();if(alertbox.length==1){var cookieName="lyqbox-alert-"+alertbox.attr("data-lyqbox");var alertCookieFound=localStorage.getItem(cookieName);if(alertCookieFound){deferred.reject()}else{self.start(alertbox);jQuery("#lyqbox-wrapper").find(".lyqbox-close-button").on("click",function alertBoxCloseButtonClicked(){var cookieName="lyqbox-alert-"+self.album[self.currentImageIndex].albumId;localStorage.setItem(cookieName,1);deferred.resolve();self.end();return false})}}else{deferred.reject()}return deferred.promise()},imageCountLabel:function(currentImageNum,totalImages){return lqx.settings.lyqBox.albumLabel.replace(/%1/g,currentImageNum).replace(/%2/g,totalImages)},enable:function(){var self=this;jQuery("body").on("click","[data-lyqbox]",function(event){self.start(jQuery(event.currentTarget));return false})},build:function(){var self=this;jQuery('<div id="lyqbox-overlay" class="lyqbox-overlay"></div>'+'<div id="lyqbox-wrapper">'+'<div class="lyqbox-content-wrapper">'+'<div class="lyqbox-content">'+"</div>"+'<div class="lyqbox-extra-content">'+'<span class="title"></span>'+'<span class="caption"></span>'+'<span class="credit"></span>'+"</div>"+'<div class="lyqbox-buttons-and-counter">'+'<span class="lyqbox-button-prev"></span>'+'<span class="lyqbox-button-next"></span>'+'<span class="lyqbox-counter"></span>'+"</div>"+'<span class="lyqbox-close-button">x</span>'+"</div>"+"</div>").appendTo(jQuery("body"));this.$lightbox=jQuery("#lyqbox-wrapper");this.$overlay=jQuery("#lyqbox-overlay");this.$container=this.$lightbox.find(".lyqbox-content");this.$outerContainer=this.$lightbox.find(".lyqbox-content-wrapper");this.containerTopPadding=parseInt(this.$container.css("padding-top"),10);this.containerRightPadding=parseInt(this.$container.css("padding-right"),10);this.containerBottomPadding=parseInt(this.$container.css("padding-bottom"),10);this.containerLeftPadding=parseInt(this.$container.css("padding-left"),10);this.$overlay.on("click",function(){if(self.album[self.currentImageIndex].type=="alert")return false;self.end();return false});this.$lightbox.hide().on("click",function(event){if(self.album[self.currentImageIndex].type=="alert")return false;if(jQuery(event.target).attr("id")==="lyqbox-wrapper"){self.end();return false}});this.$lightbox.find(".lyqbox-button-prev").on("click",function(){if(self.currentImageIndex===0){self.changeContent(self.album.length-1)}else{self.changeContent(self.currentImageIndex-1)}return false});this.$lightbox.find(".lyqbox-button-next").on("click",function(){if(self.currentImageIndex===self.album.length-1){self.changeContent(0)}else{self.changeContent(self.currentImageIndex+1)}return false});this.$lightbox.find(".lyqbox-close-button").on("click",function(){if(self.album[self.currentImageIndex].type=="alert")return false;self.end();return false})},start:function($link){var self=this;var $window=jQuery(window);$window.on("resize",jQuery.proxy(this.sizeOverlay,this));jQuery("select, object, embed").css({visibility:"hidden"});this.sizeOverlay();this.album=[];var imageNumber=0;function addToAlbum($link){self.album.push({albumId:$link.attr("data-lyqbox"),type:$link.attr("data-lyqbox-type"),link:$link.attr("data-lyqbox-url"),title:$link.attr("data-lyqbox-title"),caption:$link.attr("data-lyqbox-caption"),credit:$link.attr("data-lyqbox-credit"),"class":$link.attr("data-lyqbox-class"),alias:$link.attr("data-lyqbox-alias"),html:$link.attr("data-lyqbox-html")})}var $links;var datalyqboxValue=$link.attr("data-lyqbox");if(datalyqboxValue){$links=jQuery($link.prop("tagName")+'[data-lyqbox="'+datalyqboxValue+'"]');for(var i=0;i<$links.length;i=++i){addToAlbum(jQuery($links[i]));if($links[i]===$link[0]){imageNumber=i}}}if(this.album.length>1){this.$lightbox.find(".lyqbox-buttons-and-counter").removeClass("hide")}else{this.$lightbox.find(".lyqbox-buttons-and-counter").addClass("hide")}var top=$window.scrollTop()+lqx.settings.lyqBox.positionFromTop;var left=$window.scrollLeft();this.$lightbox.css({top:top+"px",left:left+"px"}).show();if(lqx.settings.lyqBox.disableScrolling){jQuery("body").addClass("lb-disable-scrolling")}this.changeContent(imageNumber)},loadHTML:function(url){var self=this,deferred=jQuery.Deferred();var $container=jQuery("<div></div>").load(url,function(response,status){if(status!=="error"){deferred.resolve($container.contents())}deferred.fail()});return deferred.promise()},changeContent:function(index){var self=this;this.disableKeyboardNav();var lyqboxContent=this.$lightbox.find(".lyqbox-content");this.$overlay.removeClass("close").addClass("open");this.$outerContainer.addClass("animating");switch(this.album[index].type){case"image":lyqboxContent.html("<img />");var $image=lyqboxContent.find("img");var preloader=new Image;preloader.src=self.album[index].link;preloader.onload=function(){var $preloader;var imageHeight;var imageWidth;var maxImageHeight;var maxImageWidth;var windowHeight;var windowWidth;$image.attr("src",self.album[index].link);$preloader=jQuery(preloader);$image.width(preloader.width);$image.height(preloader.height);if(lqx.settings.lyqBox.fitImagesInViewport){windowWidth=jQuery(window).width();windowHeight=jQuery(window).height();maxImageWidth=windowWidth-self.containerLeftPadding-self.containerRightPadding-20;maxImageHeight=windowHeight-self.containerTopPadding-self.containerBottomPadding-220;if(lqx.settings.lyqBox.maxWidth&&lqx.settings.lyqBox.maxWidth<maxImageWidth){maxImageWidth=lqx.settings.lyqBox.maxWidth}if(lqx.settings.lyqBox.maxHeight&&lqx.settings.lyqBox.maxHeight<maxImageHeight){maxImageHeight=lqx.settings.lyqBox.maxHeight}if(preloader.width>maxImageWidth||preloader.height>maxImageHeight){if(preloader.width/maxImageWidth>preloader.height/maxImageHeight){imageWidth=maxImageWidth;imageHeight=parseInt(preloader.height/(preloader.width/imageWidth),10);$image.width(imageWidth);$image.height(imageHeight)}else{imageHeight=maxImageHeight;imageWidth=parseInt(preloader.width/(preloader.height/imageHeight),10);$image.width(imageWidth);$image.height(imageHeight)}}}self.$lightbox.find(".lyqbox-content-wrapper").width(preloader.width);self.sizeContainer($image.width(),$image.height())},self.currentImageIndex=index;window.location.hash=self.album[self.currentImageIndex].albumId+"_"+self.album[self.currentImageIndex].alias;break;case"video":lyqboxContent.html("<iframe></iframe>");var $video=lyqboxContent.find("iframe");$video.attr("src",self.album[index].link);var maxVideoHeight;var maxVideoWidth;if(lqx.settings.lyqBox.fitImagesInViewport){windowWidth=jQuery(window).width();windowHeight=jQuery(window).height();maxVideoWidth=windowWidth*70/100;maxVideoHeight=maxVideoWidth/16*9}if(lqx.settings.lyqBox.maxWidth&&lqx.settings.lyqBox.maxWidth<maxVideoWidth){maxVideoWidth=lqx.settings.lyqBox.maxWidth;maxVideoHeight=maxVideoWidth/16*9}$video.attr("width",maxVideoWidth).attr("height",maxVideoHeight);this.currentImageIndex=index;self.sizeContainer(maxVideoWidth,maxVideoHeight);window.location.hash=self.album[self.currentImageIndex].albumId+"_"+self.album[self.currentImageIndex].alias;break;case"alert":if(self.album[index].link!=""){var promise=loadHTML(self.album[index].link);promise.done(function htmlLoaded(htmlResult){if(htmlResult!=""){lyqboxContent.html(htmlResult);self.currentImageIndex=index}})}else{lyqboxContent.html(self.album[index].html);self.currentImageIndex=index}break;default:break}},sizeOverlay:function(){this.$overlay.width(jQuery(document).width()).height(jQuery(document).height())},sizeContainer:function(imageWidth,imageHeight){var self=this;var oldWidth=this.$outerContainer.outerWidth();var oldHeight=this.$outerContainer.outerHeight();var newWidth=imageWidth+this.containerLeftPadding+this.containerRightPadding;var newHeight=imageHeight+this.containerTopPadding+this.containerBottomPadding;function postResize(){self.$lightbox.find(".lyqbox-content-wrapper").width(newWidth);self.showImage()}postResize()},showImage:function(){this.updateNav();this.updateDetails();this.enableKeyboardNav()},updateNav:function(){var alwaysShowNav=false;try{document.createEvent("TouchEvent");alwaysShowNav=lqx.settings.lyqBox.alwaysShowNavOnTouchDevices?true:false}catch(e){}if(this.album.length>1){if(lqx.settings.lyqBox.wrapAround){if(alwaysShowNav){this.$lightbox.find(".lyqbox-button-prev, .lyqbox-button-next").css("opacity","1")}this.$lightbox.find(".lyqbox-button-prev, .lyqbox-button-next").removeClass("hide")}else{if(alwaysShowNav){this.$lightbox.find(".lyqbox-button-prev, .lyqbox-button-next").css("opacity","0")}this.$lightbox.find(".lyqbox-button-prev, .lyqbox-button-next").addClass("hide");if(this.currentImageIndex!=0){this.$lightbox.find(".lyqbox-button-prev").removeClass("hide");if(alwaysShowNav){this.$lightbox.find(".lyqbox-button-prev").css("opacity","1")}}if(this.currentImageIndex!=this.album.length-1){this.$lightbox.find(".lyqbox-button-next").removeClass("hide");if(alwaysShowNav){this.$lightbox.find(".lyqbox-button-next").css("opacity","1")}}}}},updateDetails:function(){var self=this;if(typeof this.album[this.currentImageIndex].title!=="undefined"&&this.album[this.currentImageIndex].title!==""){this.$lightbox.find(".lyqbox-extra-content .title").html(this.album[this.currentImageIndex].title)}if(typeof this.album[this.currentImageIndex].caption!=="undefined"&&this.album[this.currentImageIndex].caption!==""){this.$lightbox.find(".lyqbox-extra-content .caption").html(this.album[this.currentImageIndex].caption)}if(typeof this.album[this.currentImageIndex].credit!=="undefined"&&this.album[this.currentImageIndex].credit!==""){this.$lightbox.find(".lyqbox-extra-content .credit").html(this.album[this.currentImageIndex].credit)}if(this.album.length>1&&lqx.settings.lyqBox.showImageNumberLabel){var labelText=this.imageCountLabel(this.currentImageIndex+1,this.album.length);this.$lightbox.find(".lyqbox-counter").text(labelText)}else{this.$lightbox.find(".lyqbox-counter").hide()}},preloadNeighboringImages:function(){if(this.album.length>this.currentImageIndex+1){var preloadNext=new Image;preloadNext.src=this.album[this.currentImageIndex+1].link}if(this.currentImageIndex>0){var preloadPrev=new Image;preloadPrev.src=this.album[this.currentImageIndex-1].link}},enableKeyboardNav:function(){jQuery(document).on("keyup.keyboard",jQuery.proxy(this.keyboardAction,this))},disableKeyboardNav:function(){jQuery(document).off(".keyboard")},keyboardAction:function(event){var KEYCODE_ESC=27;var KEYCODE_LEFTARROW=37;var KEYCODE_RIGHTARROW=39;var keycode=event.keyCode;var key=String.fromCharCode(keycode).toLowerCase();if(keycode===KEYCODE_ESC||key.match(/x|o|c/)){this.end()}else if(key==="p"||keycode===KEYCODE_LEFTARROW){if(this.currentImageIndex!==0){this.changeContent(this.currentImageIndex-1)}else if(lqx.settings.lyqBox.wrapAround&&this.album.length>1){
this.changeContent(this.album.length-1)}}else if(key==="n"||keycode===KEYCODE_RIGHTARROW){if(this.currentImageIndex!==this.album.length-1){this.changeContent(this.currentImageIndex+1)}else if(lqx.settings.lyqBox.wrapAround&&this.album.length>1){this.changeContent(0)}}},end:function(){this.disableKeyboardNav();jQuery(window).off("resize",this.sizeOverlay);this.$lightbox.fadeOut(lqx.settings.lyqBox.fadeDuration);this.$overlay.removeClass("open").addClass("close");jQuery("select, object, embed").css({visibility:"visible"});if(lqx.settings.lyqBox.disableScrolling){jQuery("body").removeClass("lb-disable-scrolling")}}}};jQuery(document).ready(function(){lqx.initImgLoadAttr();lqx.getBrowser=lqx.getBrowser();lqx.getOS=lqx.getOS();lqx.browserFixes();lqx.initLogging();lqx.initTracking();lqx.initMobileMenu();lqx.initEqualHeightRows();lqx.imageCaption();lqx.lineBreakSymbol();lqx.initMutationObserver();lqx.lyqBox.init()});jQuery(window).load(function(){lqx.bodyScreenSize();lqx.hangingPunctuation();lqx.equalHeightRows()});jQuery(window).scroll(function(){if(!lqx.vars.scrollThrottle){jQuery(document).trigger("scrollthrottle");lqx.vars.scrollThrottle=true;setTimeout(function(){jQuery(document).trigger("scrollthrottle");lqx.vars.scrollThrottle=false},lqx.settings.scrollThrottle.duration)}});jQuery(window).resize(function(){if(!lqx.vars.resizeThrottle){jQuery(document).trigger("resizethrottle");lqx.vars.resizeThrottle=true;setTimeout(function(){jQuery(document).trigger("resizethrottle");lqx.vars.resizeThrottle=false},lqx.settings.resizeThrottle.duration)}});jQuery(window).on("orientationchange",function(){lqx.bodyScreenSize()});jQuery(window).on("screensizechange",function(){lqx.equalHeightRows();lqx.hangingPunctuation()});jQuery(window).on("scrollthrottle",function(){});jQuery(window).on("resizethrottle",function(){lqx.bodyScreenSize()});function onYouTubeIframeAPIReady(){for(var playerId in lqx.vars.youtubePlayers){if(typeof lqx.vars.youtubePlayers[playerId].playerObj=="undefined"){lqx.vars.youtubePlayers[playerId].playerObj=new YT.Player(playerId,{events:{onReady:function(e){lqx.youtubePlayerReady(e,playerId)},onStateChange:function(e){lqx.youtubePlayerStateChange(e,playerId)}}})}}}
