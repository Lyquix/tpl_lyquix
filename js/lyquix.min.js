"use strict";if(typeof lqx!=="undefined"){console.error("`lqx` already exist!")}else if(typeof jQuery=="undefined"){console.error("`jQuery` has not been loaded!")}else{var lqx=function(){var opts={debug:false,siteURL:null,tmplURL:null,analytics:{enabled:true},detect:{enabled:true},fixes:{enabled:true},geolocate:{enabled:true},lyqbox:{enabled:true},menu:{enabled:true},mutation:{enabled:true},responsive:{enabled:true},util:{enabled:true}};var vars={analytics:{},detect:{},fixes:{},geolocate:{},lyqbox:{},menu:{},mutation:{},responsive:{},util:{},window:jQuery(window),document:jQuery(document),html:jQuery(document.html),body:null,scrollThrottle:false,resizeThrottle:false};var init=function(){lqx.log("Initializing `lqx`");lqx.log("Setup scrollthrottle event");lqx.vars.window.scroll(function(){if(!lqx.vars.scrollThrottle){lqx.vars.document.trigger("scrollthrottle");lqx.vars.scrollThrottle=true;setTimeout(function(){lqx.vars.scrollThrottle=false;lqx.vars.document.trigger("scrollthrottle")},15)}});lqx.log("Setup resizethrottle event");lqx.vars.window.resize(function(){if(!lqx.vars.resizeThrottle){lqx.vars.document.trigger("resizethrottle");lqx.vars.resizeThrottle=true;setTimeout(function(){lqx.vars.resizeThrottle=false;lqx.vars.document.trigger("resizethrottle")},15)}});lqx.vars.document.ready(function(){comicfy();almost7()});return lqx.init=true};var options=function(o){if(typeof o=="object"){jQuery.extend(true,opts,o);lqx.log("Options updated",opts)}return opts};var ready=function(opts){if(typeof opts=="object")lqx.options(opts);lqx.vars.body=jQuery(document.body);lqx.log("lqxready event");lqx.vars.window.trigger("lqxready");return lqx.ready=true};var log=function(){if(opts.debug){for(i=0;i<arguments.length;i++){console.log(arguments[i])}}};var warn=function(){if(opts.debug){for(i=0;i<arguments.length;i++){console.warn(arguments[i])}}};var error=function(){if(opts.debug){for(i=0;i<arguments.length;i++){console.error(arguments[i])}}};var comicfy=function(){if("detect"in lqx&&"comicfy"in lqx.detect.urlParams()){lqx.log("Comicfy!");var link=document.createElement("link");link.href=lqx.vars.tmplURL+"/fonts/comicneue/comicfy.css";link.type="text/css";link.rel="stylesheet";document.getElementsByTagName("head")[0].appendChild(link)}};var almost7=function(){if("detect"in lqx&&"almost7"in lqx.detect.urlParams()){lqx.log("I am still 6 but almost 7!");var link=document.createElement("link");link.href=lqx.vars.tmplURL+"/fonts/still-6-but-almost-7/still-6-but-almost-7.css";link.type="text/css";link.rel="stylesheet";document.getElementsByTagName("head")[0].appendChild(link)}};var version="2.0.0";return{opts:opts,vars:vars,init:init,options:options,ready:ready,log:log,warn:warn,error:error,version:version}}();lqx.init()}if(lqx&&typeof lqx.util=="undefined"){lqx.util={cookie:function(name,value,attributes){if(arguments.length===0||!name)return false;if(arguments.length==1){return decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(name).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||null}var c=encodeURIComponent(name)+"="+encodeURIComponent(value);if(typeof attributes=="object"){if("maxAge"in attributes)c+="; max-age="+parseInt(attributes.maxAge);if("expires"in attributes&&attributes.expires instanceof Date)c+="; expires="+attributes.expires.toUTCString();if("path"in attributes)c+="; path="+attributes.path;if("domain"in attributes)c+="; domain="+attributes.domain;if("secure"in attributes)c+="; secure";if("httpOnly"in attributes)c+="; httponly"}document.cookie=c;return true},uniqueUrl:function(sel,attrib){var elems=jQuery(sel);if(elems.length){var d=new Date;var s=(d.getTime()*1e3+d.getMilliseconds()).toString(36);elems.each(function(){var url=jQuery(this).attr(attrib);if(typeof url!="undefined"){jQuery(this).attr(attrib,url+(url.indexOf("?")!==-1?"&":"?")+s+parseInt(Math.random()*1e7).toString(36))}})}},swipe:function(sel,callback){var swp={sX:0,sY:0,eX:0,eY:0,dir:""};var opts={minX:30,maxX:150,minY:30,maxY:150};var elem=jQuery(sel);elem.on("touchstart",function(e){var t=e.originalEvent.touches[0];swp.sX=t.clientX;swp.sY=t.clientY});elem.on("touchmove",function(e){if(!e.is(".content-wrapper .content.html"))e.preventDefault();var t=e.originalEvent.touches[0];swp.eX=t.clientX;swp.eY=t.clientY});elem.on("touchend",function(e){if(Math.abs(swp.eX-swp.sX)>opts.minX&&Math.abs(swp.eY-swp.sY)<opts.maxY&&swp.eX>0){if(swp.eX>swp.sX)swp.dir="rt";else swp.dir="lt"}else if(Math.abs(swp.eY-swp.sY)>opts.minY&&Math.abs(swp.eX-swp.sX)<opts.maxX&&swp.eY>0){if(swp.eY>swp.sY)swp.dir="dn";else swp.dir="up"}if(swp.dir&&typeof callback=="function")callback(sel,swp.dir);swp={sX:0,sY:0,eX:0,eY:0,dir:""}})}}}if(lqx&&typeof lqx.detect=="undefined"){lqx.detect=function(){var vars={mobile:null,browser:null,os:null,urlParts:{},urlParams:{}};var init=function(){if(lqx.opts.detect.enabled){lqx.log("Initializing `detect`");jQuery.extend(lqx.vars.detect,vars);vars=lqx.vars.detect;lqx.vars.window.on("lqxready",function(){detectMobile();detectBrowser();detectOS();detectUrlParts();detectUrlParams()})}return lqx.detect.init=true};var mobile=function(){return vars.mobile};var browser=function(){return vars.browser};var os=function(){return vars.os};var urlParts=function(){return vars.urlParts};var urlParams=function(){return vars.urlParams};var detectMobile=function(){if(typeof MobileDetect=="function"){var md=new MobileDetect(window.navigator.userAgent);var r={mobile:false,phone:false,tablet:false};if(md.mobile()!==null){r.mobile=true;lqx.vars.body.addClass("mobile");if(md.phone()!==null){r.phone=true;lqx.vars.body.addClass("phone")}if(md.tablet()!==null){r.tablet=true;lqx.vars.body.addClass("tablet")}}lqx.log("Detect mobile",r);vars.mobile=r;return true}else{lqx.warn("MobileDetect library not loaded");return false}};var detectBrowser=function(){var ua=navigator.userAgent,browser;function getFirstMatch(regex){var match=ua.match(regex);return match&&match.length>1&&match[1]||""}function getSecondMatch(regex){var match=ua.match(regex);return match&&match.length>1&&match[2]||""}if(/opera|opr/i.test(ua)){browser={name:"Opera",type:"opera",version:getFirstMatch(/version\/(\d+(\.\d+)?)/i)||getFirstMatch(/(?:opera|opr)[\s\/](\d+(\.\d+)?)/i)}}else if(/msie|trident/i.test(ua)){browser={name:"Internet Explorer",type:"msie",version:getFirstMatch(/(?:msie |rv:)(\d+(\.\d+)?)/i)}}else if(/chrome.+? edge/i.test(ua)){browser={name:"Microsft Edge",type:"msedge",version:getFirstMatch(/edge\/(\d+(\.\d+)?)/i)}}else if(/chrome|crios|crmo/i.test(ua)){browser={name:"Google Chrome",type:"chrome",version:getFirstMatch(/(?:chrome|crios|crmo)\/(\d+(\.\d+)?)/i)}}else if(/firefox/i.test(ua)){browser={name:"Firefox",type:"firefox",version:getFirstMatch(/(?:firefox)[ \/](\d+(\.\d+)?)/i)}}else if(!/like android/i.test(ua)&&/android/i.test(ua)){browser={name:"Android",type:"android",version:getFirstMatch(/version\/(\d+(\.\d+)?)/i)}}else if(/safari/i.test(ua)){browser={name:"Safari",type:"safari",version:getFirstMatch(/version\/(\d+(\.\d+)?)/i)}}else{browser={name:getFirstMatch(/^(.*)\/(.*) /),version:getSecondMatch(/^(.*)\/(.*) /)};browser.type=browser.name.toLowerCase().replace(/\s/g,"")}if(browser.type&&browser.version){jQuery(document).ready(function(){lqx.vars.body.addClass(browser.type);lqx.vars.body.addClass(browser.type+"-"+browser.version.split(".")[0]);lqx.vars.body.addClass(browser.type+"-"+browser.version.replace(/\./g,"-"))})}lqx.log("Detect browser",browser);vars.browser=browser;return true};var detectOS=function(){var ua=navigator.userAgent,os;function getFirstMatch(regex){var match=ua.match(regex);return match&&match.length>1&&match[1]||""}function getSecondMatch(regex){var match=ua.match(regex);return match&&match.length>1&&match[2]||""}if(/(ipod|iphone|ipad)/i.test(ua)){os={name:"iOS",type:"ios",version:getFirstMatch(/os (\d+([_\s]\d+)*) like mac os x/i).replace(/[_\s]/g,".")}}else if(/windows phone/i.test(ua)){os={name:"Windows Phone",type:"windowsphone",version:getFirstMatch(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i)}}else if(!/like android/i.test(ua)&&/android/i.test(ua)){os={name:"Android",type:"android",version:getFirstMatch(/android[ \/-](\d+(\.\d+)*)/i)}}else if(/windows nt/i.test(ua)){os={name:"Windows",type:"windows",version:getFirstMatch(/windows nt (\d+(\.\d+)*)/i)}}else if(/mac os x/i.test(ua)){os={name:"Mac OS X",type:"macosx",version:getFirstMatch(/mac os x (\d+([_\s]\d+)*)/i).replace(/[_\s]/g,".")}}else if(/ubuntu/i.test(ua)){os={name:"Ubuntu",type:"ubuntu",version:getFirstMatch(/ubuntu\/(\d+(\.\d+)*)/i)}}else if(/fedora/i.test(ua)){os={name:"Fedora",type:"fedora",version:getFirstMatch(/fedora\/(\d+(\.\d+)*)/i)}}else if(/CrOS/.test(ua)){os={name:"Chrome OS",type:"chromeos",version:getSecondMatch(/cros (.+) (\d+(\.\d+)*)/i)}}if(os.type&&os.version){jQuery(document).ready(function(){lqx.vars.body.addClass(os.type);lqx.vars.body.addClass(os.type+"-"+os.version.split(".")[0]);lqx.vars.body.addClass(os.type+"-"+os.version.replace(/\./g,"-"))})}lqx.log("Detect O/S",os);vars.os=os;return true};var detectUrlParts=function(){lqx.vars.body.attr("domain",window.location.hostname);vars.urlParts.domain=window.location.hostname;lqx.vars.body.attr("path",window.location.pathname);vars.urlParts.path=window.location.pathname;lqx.vars.body.attr("hash",window.location.hash.substring(1));vars.urlParts.hash=window.location.hash.substring(1);lqx.vars.window.on("hashchange",function(){lqx.vars.body.attr("hash",window.location.hash.substring(1));vars.urlParts.hash=window.location.hash.substring(1)});lqx.log("Detect URL parts")};var detectUrlParams=function(){var params=window.location.search.substr(1).split("&");if(params.length){params.forEach(function(param){param=param.split("=",2);if(param.length==2)vars.urlParams[param[0]]=decodeURIComponent(param[1].replace(/\+/g," "));else vars.urlParams[param[0]]=null})}lqx.log("Detect URL params")};return{init:init,mobile:mobile,os:os,browser:browser,urlParts:urlParts,urlParams:urlParams}}();lqx.detect.init()}"use strict";if(lqx&&typeof lqx.geolocate=="undefined"){lqx.geolocate=function(){var opts={gps:false};var vars={location:{city:null,subdivision:null,country:null,continent:null,time_zone:null,lat:null,lon:null,radius:null}};var init=function(){if(lqx.opts.geolocate.enabled){lqx.log("Initializing `geolocate`");jQuery.extend(lqx.opts.geolocate,opts);opts=lqx.opts.geolocate;jQuery.extend(lqx.vars.geolocate,vars);vars=lqx.vars.geolocate;lqx.vars.window.on("lqxready",function(){geoLocate()})}return lqx.geolocate.init=true};var location=function(){return vars.location};var geoLocate=function(){jQuery.ajax({async:true,cache:false,dataType:"json",url:lqx.opts.tmplURL+"/php/ip2geo/",success:function(data,status,xhr){vars.location=data;if(opts.gps&&"geolocate"in navigator){navigator.geolocate.getCurrentPosition(function(position){vars.location.lat=position.coords.latitude;vars.location.lon=position.coords.longitude;vars.location.radius=0})}for(var key in vars.location){if(key=="time_zone"){lqx.vars.body.attr("time-zone",vars.location[key])}else{lqx.vars.body.attr(key,vars.location[key])}}lqx.log("geolocate",vars.location);lqx.log("geolocate event");jQuery(document).trigger("geolocateready")},error:function(xhr,status,error){lqx.error("Geolocate error "+status+" "+error)}})};return{init:init,location:location}}();lqx.geolocate.init()}if(lqx&&typeof lqx.mutation=="undefined"){lqx.mutation=function(){var vars={observer:null,addNode:[],removeNode:[],modAttrib:[]};var init=function(){if(lqx.opts.mutation.enabled){lqx.log("Initializing `mutation`");jQuery.extend(lqx.vars.mutation,vars);vars=lqx.vars.mutation;lqx.vars.window.on("lqxready",function(){observer()})}return lqx.mutation.init=true};var observer=function(){var mo=window.MutationObserver||window.WebKitMutationObserver;if(typeof mo!=="undefined"){vars.observer=new mo(handler);vars.observer.observe(document,{childList:true,subtree:true,attributes:true})}else{jQuery(document).on("DOMNodeInserted DOMNodeRemoved DOMAttrModified",function(e){handler(e)})}};var addHandler=function(type,selector,callback){switch(type){case"addNode":vars.addNode.push({selector:selector,callback:callback});break;case"removeNode":vars.removeNode.push({selector:selector,callback:callback});break;case"modAttrib":vars.modAttrib.push({selector:selector,callback:callback});break}};var handler=function(mutRecs){if(!(mutRecs instanceof Array)){mutRecs=[mutRecs]}mutRecs.forEach(function(mutRec){switch(mutRec.type){case"childList":if(mutRec.addedNodes.length>0){vars.addNode.forEach(function(h){if(mutRec.target.matches(h.selector))h.callback(mutRec.target)})}if(mutRec.removedNodes.length>0){vars.removeNode.forEach(function(h){if(mutRec.target.matches(h.selector))h.callback(mutRec.target)})}break;case"DOMNodeInserted":vars.addNode.forEach(function(h){if(mutRec.target.matches(h.selector))h.callback(mutRec.target)});break;case"DOMNodeRemoved":vars.removeNode.forEach(function(h){if(mutRec.target.matches(h.selector))h.callback(mutRec.target)});break;case"attributes":case"DOMAttrModified":vars.modAttrib.forEach(function(h){if(mutRec.target.matches(h.selector))h.callback(mutRec.target)});break}})};return{init:init,addHandler:addHandler}}();lqx.mutation.init()}if(lqx&&typeof lqx.responsive=="undefined"){lqx.responsive=function(){var opts={sizes:["xs","sm","md","lg","xl"],breakPoints:[320,640,960,1280,1600],minIndex:0,maxIndex:4};var vars={screen:null,orientation:null};var init=function(){if(lqx.opts.responsive.enabled){lqx.log("Initializing `responsive`");jQuery.extend(lqx.opts.responsive,opts);opts=lqx.opts.responsive;jQuery.extend(lqx.vars.responsive,vars);vars=lqx.vars.responsive;lqx.vars.window.on("lqxready resizethrottle orientationchange",function(){setScreen()});if("orientation"in window.screen){lqx.vars.window.on("lqxready orientationchange",function(){setOrientation()})}}return lqx.responsive.init=true};var screen=function(){return vars.screen};var orientation=function(){return vars.orientation};var setScreen=function(){var w=lqx.vars.window.width();var s=null;if(w<opts.breakPoints[1])s=0;else if(w>=opts.breakPoints[1]&&w<opts.breakPoints[2])s=1;else if(w>=opts.breakPoints[2]&&w<opts.breakPoints[3])s=2;else if(w>=opts.breakPoints[3]&&w<opts.breakPoints[4])s=3;else if(w>=opts.breakPoints[4])s=4;if(s<opts.minIndex)s=opts.minIndex;if(s>opts.maxIndex)s=opts.maxIndex;if(opts.sizes[s]!=vars.screen){lqx.vars.body.attr("screen",opts.sizes[s]);vars.screen=opts.sizes[s];lqx.vars.document.trigger("screensizechange");lqx.log("Screen size changed",vars.screen)}return true};var setOrientation=function(){var o=window.screen.orientation.type;if(o.indexOf(vars.orientation)!=-1){switch(o){case"portrait-primary":case"portrait-secondary":vars.orientation="portrait";lqx.vars.body.attr("orientation","portrait");break;case"landscape-primary":case"landscape-secondary":vars.orientation="landscape";lqx.vars.body.attr("orientation","landscape");break}lqx.log("Screen orientation changed",vars.orientation)}return true};return{init:init,screen:screen,orientation:orientation}}();lqx.responsive.init()}if(lqx&&typeof lqx.fixes=="undefined"){lqx.fixes=function(){var init=function(){if(lqx.opts.fixes.enabled){lqx.log("Initializing `fixes`");if(lqx.detect.browser.type=="msie"){lqx.vars.document.ready(function(){imgWidthAttrib();fontFeatureopts();cssGrid()});lqx.vars.window.on("screensizechange orientationchange",function(){cssGrid()})}matchesPolyfill()}return lqx.fixes.init=true};var imgWidthAttrib=function(){jQuery("img").each(function(){var img=jQuery(this);if(img.attr("width")===undefined)setImgWidth(img)});lqx.mutation.addHandler("addNode","img",function(e){var img=jQuery(e.target);if(img.attr("width")===undefined)setImgWidth(img)});lqx.log("Image width attribute fix for IE")};var setImgWidth=function(img){var newimg=new Image;newimg.onload=function(){img.attr("width",newimg.width)};newimg.src=img.attr("src")};var fontFeatureopts=function(){jQuery("<style>html, sup, sub, samp, td, th, h1, h2, h3, .font-monospace, .font-smallcaps, .font-uppercase {font-feature-opts: normal;}</style>").appendTo("head");lqx.log("Font feature opts property fix for IE10/11")};var cssGrid=function(){var gridElems=jQuery("*").filter(function(){if(jQuery(this).css("display")=="-ms-grid"){return true}});if(gridElems.length){gridElems.each(function(){var colCount=jQuery(this).css("-ms-grid-columns").split(" ").length;var row=1;var col=1;gridElem.children().each(function(){jQuery(this).css({"-ms-grid-column":col,"-ms-grid-column-span":"1","-ms-grid-row":row,"-ms-grid-row-span":"1"});col++;if(col>colCount){row++;col=1}})})}};var matchesPolyfill=function(){if(!Element.prototype.matches){Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(s){var matches=(this.document||this.ownerDocument).querySelectorAll(s),i=matches.length;while(--i>=0&&matches.item(i)!==this){}return i>-1}}};return{init:init}}();lqx.fixes.init()}if(lqx&&typeof lqx.menu=="undefined"){lqx.menu=function(){var opts={screens:["sm","xs"]};var init=function(){if(lqx.opts.menu.enabled){lqx.log("Initializing `menu`");jQuery.extend(lqx.opts.menu,opts);opts=lqx.opts.menu;lqx.vars.window.on("lqxready",function(){setup()});lqx.vars.window.on("screensizechange",function(){reset()})}return lqx.menu.init=true};var setup=function(){lqx.vars.body.on("click",".horizontal a, .vertical a, .slide-out a",function(e){e.preventDefault();click(this)});lqx.vars.body.on("click",".horizontal, .vertical, .slide-out",function(e){e.stopPropagation()});lqx.vars.body.on("click",".slide-out .menu-control",function(){var elem=jQuery(this).parent();if(jQuery(elem).hasClass("open")){jQuery(elem).removeClass("open")}else{jQuery(elem).addClass("open")}});lqx.vars.body.click(function(){jQuery(".horizontal, .vertical, .slide-out").find(".open").removeClass("open");jQuery(".slide-out.open").removeClass("open")})};var click=function(elem){var li=jQuery(elem).parent();var url=elem.href;var target=elem.target&&!elem.target.match(/^_(self|parent|top)$/i)?elem.target:false;var go=function(){if(target){window.open(url,target)}else{window.location.href=url}};if(jQuery.inArray(lqx.responsive.screen,opts.screens)!=-1){if(jQuery(li).hasClass("deeper")||jQuery(li).hasClass("menu-item-has-children")){if(jQuery(li).hasClass("open")){go()}else{jQuery(li).siblings(".open").find(".open").removeClass("open");jQuery(li).siblings(".open").removeClass("open");jQuery(li).addClass("open")}}else{go()}}else{go()}};var reset=function(){if(jQuery.inArray(lqx.responsive.screen,opts.screens)==-1){jQuery(".deeper.open, .menu-item-has-children.open").removeClass("open")}};return{init:init}}();lqx.menu.init()}if(lqx&&typeof lqx.lyqbox=="undefined"){lqx.lyqbox=function(){var opts={html:'<div class="lyqbox">'+'<div class="content-wrapper">'+'<div class="content"></div>'+'<div class="info">'+'<div class="title"></div>'+'<div class="caption"></div>'+'<div class="credit"></div>'+"</div>"+"</div>"+'<div class="content-wrapper">'+'<div class="content"></div>'+'<div class="info">'+'<div class="title"></div>'+'<div class="caption"></div>'+'<div class="credit"></div>'+"</div>"+"</div>"+'<div class="close"></div>'+'<div class="prev"></div>'+'<div class="next"></div>'+'<div class="counter">'+'<span class="current"></span>'+' of <span class="total"></span>'+"</div>"+"</div>"};var vars={album:[],currentImageIndex:0,initialized:false};var init=function(){if(lqx.opts.lyqbox.enabled){lqx.log("Initializing `lyqbox`");jQuery.extend(lqx.opts.lyqbox,opts);opts=lqx.opts.lyqbox;jQuery.extend(lqx.vars.lyqbox,vars);vars=lqx.vars.lyqbox;lqx.vars.window.on("lqxready",function(){lqx.mutation.addHandler("addNode","[data-lyqbox]",function(e){setup()})});lqx.vars.window.ready(function(){if(jQuery("[data-lyqbox]").length){setup()}})}return lqx.lyqbox.init=true};var setup=function(){if(!vars.initialized){enable();build();var alertPromise=alert(jQuery("[data-lyqbox-type=alert]"));alertPromise.always(function afterAlertCheck(){hash()});vars.initialized=true}};var hash=function(){if(window.location.hash.substr(1)!==""){var contentData=window.location.hash.substr(1).split("_");if(jQuery("[data-lyqbox="+contentData[0]+"][data-lyqbox-alias="+contentData[1]+"]").length){start(jQuery("[data-lyqbox="+contentData[0]+"][data-lyqbox-alias="+contentData[1]+"]"))}}};var alert=function(alertbox){var deferred=jQuery.Deferred();if(alertbox.length==1){var cookieName="lyqbox-alert-"+alertbox.attr("data-lyqbox");var alertCookieFound=localStorage.getItem(cookieName);if(alertCookieFound){deferred.reject()}else{start(alertbox);jQuery(".lyqbox .close").on("click",function alertBoxCloseButtonClicked(){var cookieName="lyqbox-alert-"+vars.album[vars.currentImageIndex].albumId;localStorage.setItem(cookieName,1);deferred.resolve();end();return false})}}else{deferred.reject()}return deferred.promise()};var enable=function(){lqx.vars.body.on("click","[data-lyqbox]",function(event){jQuery(".lyqbox").addClass("open");start(jQuery(event.currentTarget));return false})};var build=function(){jQuery(opts.html).appendTo(lqx.vars.body);vars.overlay=jQuery(".lyqbox");vars.containerActive=vars.overlay.find(".content-wrapper").first().addClass("active");lqx.util.swipe(".lyqbox .content-wrapper",swipeHandler);vars.overlay.find(".prev").on("click",function(){if(vars.currentImageIndex===0){changeContent(vars.album.length-1)}else{changeContent(vars.currentImageIndex-1)}return false});vars.overlay.find(".next").on("click",function(){if(vars.currentImageIndex===vars.album.length-1){changeContent(0)}else{changeContent(vars.currentImageIndex+1)}return false});vars.overlay.find(".close").on("click",function(){if(vars.album[vars.currentImageIndex].type=="alert")return false;end();return false})};var stopVideo=function(type){if(type=="video"){vars.containerActive.find(".content.video .video-container iframe").remove()}};var start=function(data){vars.album=[];var currentIndex=0;function addToAlbum(data){vars.album.push({albumId:data.attr("data-lyqbox"),type:data.attr("data-lyqbox-type"),link:data.attr("data-lyqbox-url"),title:data.attr("data-lyqbox-title"),caption:data.attr("data-lyqbox-caption"),credit:data.attr("data-lyqbox-credit"),class:data.attr("data-lyqbox-class"),alias:data.attr("data-lyqbox-alias"),html:data.attr("data-lyqbox-html")})}var items;var datalyqboxValue=data.attr("data-lyqbox");if(datalyqboxValue){items=jQuery(data.prop("tagName")+'[data-lyqbox="'+datalyqboxValue+'"]');for(var i=0;i<items.length;i=++i){addToAlbum(jQuery(items[i]));if(items[i]===data[0]){currentIndex=i}}}changeContent(currentIndex)};var loadHTML=function(url){var deferred=jQuery.Deferred();var $container=jQuery("<div></div>").load(url,function(response,status){if(status!=="error"){deferred.resolve($container.contents())}deferred.fail()});return deferred.promise()};var addHash=function(){if(vars.album[vars.currentImageIndex].alias)window.location.hash=vars.album[vars.currentImageIndex].albumId+"_"+vars.album[vars.currentImageIndex].alias};var changeContent=function(index){disableKeyboardNav();vars.overlay.addClass("open");var promise=jQuery.Deferred();switch(vars.album[index].type){case"image":var image=jQuery("<img />");var preloader=new Image;preloader.src=vars.album[index].link;preloader.onload=function(){var preloaderObject;image.attr("src",vars.album[index].link);preloaderObject=jQuery(preloader);updateContent(image,index,vars.album[index].type);addHash();window.getComputedStyle(image[0]).opacity()};break;case"video":var video=jQuery("<iframe></iframe>");video.attr("src",vars.album[index].link);updateContent('<div class="video-container">'+video.prop("outerHTML")+"</div>",index,vars.album[index].type);addHash();break;case"html":case"alert":if(vars.album[index].link!==""&&typeof vars.album[index].link!=="undefined"){promise=loadHTML(vars.album[index].link);promise.done(function htmlLoaded(htmlResult){if(htmlResult!=="")updateContent(htmlResult,index,vars.album[index].type)})}else{updateContent(vars.album[index].html,index,vars.album[index].type)}break;default:break}};var updateContent=function(content,index,type){stopVideo(type);vars.overlay.find(".content-wrapper").not(".active").addClass("active").find(".content").removeClass().addClass("content "+type).empty().append(content);vars.containerActive.removeClass("active");vars.containerActive=vars.overlay.find(".content-wrapper.active");vars.currentImageIndex=index;updateUIandKeyboard()};var updateUIandKeyboard=function(){updateUI();enableKeyboardNav()};var updateUI=function(){if(vars.album[vars.currentImageIndex].type!="alert"){if(typeof vars.album[vars.currentImageIndex].title!=="undefined"&&vars.album[vars.currentImageIndex].title!==""){vars.overlay.find(".title").html(vars.album[vars.currentImageIndex].title)}else{vars.overlay.find(".title").html("")}if(typeof vars.album[vars.currentImageIndex].caption!=="undefined"&&vars.album[vars.currentImageIndex].caption!==""){vars.overlay.find(".caption").html(vars.album[vars.currentImageIndex].caption)}else{vars.overlay.find(".caption").html("")}if(typeof vars.album[vars.currentImageIndex].credit!=="undefined"&&vars.album[vars.currentImageIndex].credit!==""){vars.overlay.find(".credit").html(vars.album[vars.currentImageIndex].credit)}else{vars.overlay.find(".credit").html("")}if(vars.album.length>1){vars.overlay.find(".current").text(vars.currentImageIndex+1);vars.overlay.find(".total").text(vars.album.length)}else{vars.overlay.find(".prev,.next").addClass("hide");vars.overlay.find(".counter").addClass("hide")}}else{vars.overlay.find(".prev,.next").addClass("hide");vars.overlay.find(".counter").addClass("hide")}};var enableKeyboardNav=function(){lqx.vars.document.on("keyup.keyboard",jQuery.proxy(keyboardAction,lqx.lyqbox))};var disableKeyboardNav=function(){lqx.vars.document.off(".keyboard")};var swipeHandler=function(sel,dir){console.log(sel,dir);if(dir=="lt")keyboardAction({keyCode:39});if(dir=="rt")keyboardAction({keyCode:37})};var keyboardAction=function(event){var KEYCODE_ESC=27;var KEYCODE_LEFTARROW=37;var KEYCODE_RIGHTARROW=39;var keycode=event.keyCode;var key=String.fromCharCode(keycode).toLowerCase();if(keycode===KEYCODE_ESC||key.match(/x|o|c/)){end()}else if(keycode===KEYCODE_LEFTARROW){if(vars.currentImageIndex===0){changeContent(vars.album.length-1)}else{changeContent(vars.currentImageIndex-1)}}else if(keycode===KEYCODE_RIGHTARROW){if(vars.currentImageIndex===vars.album.length-1){changeContent(0)}else{changeContent(vars.currentImageIndex+1)}}};var removeHash=function(){var scrollV,scrollH,loc=window.location;if("pushState"in history)history.pushState("",document.title,loc.pathname+loc.search);else{scrollV=document.body.scrollTop;scrollH=document.body.scrollLeft;loc.hash="";document.body.scrollTop=scrollV;document.body.scrollLeft=scrollH}};var end=function(){disableKeyboardNav();vars.overlay.removeClass("open");stopVideo(vars.album[vars.currentImageIndex].type);removeHash()};return{init:init}}();lqx.lyqbox.init()}if(lqx&&typeof lqx.analytics=="undefined"){lqx.analytics=function(){var opts={downloads:true,outbound:true,scrollDepth:true,photoGallery:true,video:true,userActive:{enabled:true,idleTime:5e3,throttle:100,refresh:250,maxTime:18e5},createParams:null,setParams:null,requireParams:null,provideParams:null,customParamsFuncs:null,abTestName:null,abTestNameDimension:null,abTestGroupDimension:null};var vars={scrollDepthMax:null,youTubeIframeAPIReady:false,youtubePlayers:{},vimeoPlayers:{},userActive:null};var init=function(){if(lqx.opts.analytics.enabled){jQuery.extend(lqx.opts.analytics,opts);opts=lqx.opts.analytics;jQuery.extend(lqx.vars.analytics,vars);vars=lqx.vars.analytics;lqx.vars.window.on("lqxready",function(){if(opts.createParams&&opts.createParams.default&&opts.createParams.default.trackingId){gaCode()}window.onYouTubeIframeAPIReady=function(){lqx.analytics.onYouTubeIframeAPIReady()}})}return lqx.analytics.init=true};var gaCode=function(){(function(i,s,o,g,r,a,m){i["GoogleAnalyticsObject"]=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date;a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,"script","https://www.google-analytics.com/analytics.js","ga");ga(lqx.analytics.gaReady)};var gaReady=function(tracker){jQuery.Deferred().done(function(){if(opts.createParams&&typeof opts.createParams=="object"){var params=opts.createParams;Object.keys(params).forEach(function(tracker){if(tracker=="default")ga("create",params[tracker].trackingId,params[tracker].cookieDomain,params[tracker].fieldsObject);else ga("create",params[tracker].trackingId,params[tracker].cookieDomain,tracker,params[tracker].fieldsObject)})}},function(){var params;if(opts.setParams&&typeof opts.setParams=="object"){params=opts.setParams;Object.keys(params).forEach(function(tracker){var cmd="set";if(tracker!="default")cmd=tracker+".set";Object.keys(params[tracker]).forEach(function(fieldName){ga(cmd,fieldName,params[tracker][fieldName])})})}if(opts.requireParams&&typeof opts.requireParams=="object"){params=opts.requireParams;Object.keys(params).forEach(function(tracker){var cmd="require";if(tracker!="default")cmd=tracker+".require";params[tracker].forEach(function(elem){ga(cmd,elem.pluginName,elem.pluginOptions)})})}if(opts.provideParams&&typeof opts.provideParams=="object"){params=opts.provideParams;Object.keys(params).forEach(function(tracker){var cmd="provide";if(tracker!="default")cmd=tracker+".provide";params[tracker].forEach(function(elem){ga(cmd,elem.pluginName,elem.pluginConstructor)})})}if(opts.abTestName!==null&&opts.abTestNameDimension!==null&&opts.abTestGroupDimension!==null){var abTestGroup=lqx.utils.cookie("abTestGroup");if(abTestGroup===null){if(Math.random()<.5)abTestGroup="A";else abTestGroup="B";lqx.utils.cookie("abTestGroup",abTestGroup,{maxAge:30*24*60*60,path:"/"})}lqx.vars.body.attr("data-abtest",abTestGroup);ga("set","dimension"+opts.abTestNameDimension,opts.abTestName);ga("set","dimension"+opts.abTestGroupDimension,abTestGroup)}},function(){if(typeof opts.customParamsFuncs=="function"){try{opts.customParamsFuncs()}catch(e){lqx.error(e)}}},function(){ga("send","pageview");initTracking()}).resolve()};var initTracking=function(){if(opts.outbound||opts.download){jQuery("a").each(function(){var elem=this;if(elem.href){if(opts.outbound&&elem.host!=location.host){jQuery(elem).click(function(e){e.preventDefault();var url=elem.href;var label=url;if(jQuery(elem).attr("title")){label=jQuery(elem).attr("title")+" ["+url+"]"}ga("send",{hitType:"event",eventCategory:"Outbound Links",eventAction:"click",eventLabel:label,nonInteraction:true,hitCallback:function(){window.location.href=url}})})}else if(opts.downloads&&elem.pathname.match(/\.(htm|html|php)$/i)[1]===null){jQuery(elem).click(function(e){e.preventDefault();var url=elem.href;var loc=elem.protocol+"//"+elem.hostname+elem.pathname+elem.search;var page=elem.pathname+elem.search;var title="Download: "+page;if(jQuery(elem).attr("title")){title=jQuery(elem).attr("title")}ga("send",{hitType:"pageview",location:loc,page:page,title:title,hitCallback:function(){window.location.href=url}})})}}})}if(opts.scrolldepth){vars.scrollDepthMax=Math.ceil((lqx.vars.window.scrollTop()+lqx.vars.window.height())/lqx.vars.document.height()*10)*10;lqx.vars.window.on("scrollthrottle",function(){if(vars.scrollDepthMax<100){vars.scrollDepthMax=Math.max(vars.scrollDepthMax,Math.ceil((lqx.vars.window.scrollTop()+lqx.vars.window.height())/lqx.vars.document.height()*10)*10);if(vars.scrollDepthMax>100)vars.scrollDepthMax=100}});lqx.vars.window.on("unload",function(){ga("send",{hitType:"event",eventCategory:"Scroll Depth",eventAction:vars.scrollDepthMax,nonInteraction:true})})}if(opts.photogallery){lqx.vars.html.on("click","a[rel^=lightbox], area[rel^=lightbox], a[data-lightbox], area[data-lightbox]",function(){ga("send",{hitType:"event",eventCategory:"Photo Gallery",eventAction:"Open"})});lqx.vars.html.on("load","img.lb-image",function(){ga("send",{hitType:"event",eventCategory:"Photo Gallery",eventAction:"Display",eventLabel:jQuery(this).attr("src")})})}if(opts.video){var tag=document.createElement("script");tag.src="https://www.youtube.com/iframe_api";tag.onload=function(){vars.youTubeIframeAPIReady=true};var firstScriptTag=document.getElementsByTagName("script")[0];firstScriptTag.parentNode.insertBefore(tag,firstScriptTag);if(window.addEventListener){window.addEventListener("message",vimeoReceiveMessage,false)}else{window.attachEvent("onmessage",vimeoReceiveMessage,false)}jQuery("iframe").each(function(){var elem=jQuery(this);initVideoPlayerAPI(elem)})}if(opts.activetime){lqx.vars.window.on("unload",function(){ga("send",{hitType:"event",eventCategory:"User Active Time",eventAction:"Percentage",eventValue:parseInt(100*vars.userActive.activeTime/(vars.userActive.activeTime+vars.userActive.inactiveTime)),nonInteraction:true});ga("send",{hitType:"event",eventCategory:"User Active Time",eventAction:"Active Time (ms)",eventValue:parseInt(vars.userActive.activeTime),nonInteraction:true});ga("send",{hitType:"event",eventCategory:"User Active Time",eventAction:"Inactive Time (ms)",eventValue:parseInt(vars.userActive.inactiveTime),nonInteraction:true})})}};var videoPlayerMutationHandler=function(mutRec){jQuery(mutRec.addedNodes).each(function(){var elem=jQuery(this);if(typeof elem.prop("tagName")!=="undefined"){var tag=elem.prop("tagName").toLowerCase();if(tag=="iframe"){initVideoPlayerAPI(elem)}}})};var initVideoPlayerAPI=function(elem){var src=elem.attr("src");var playerId=elem.attr("id");var urlconn;if(typeof src!="undefined"){if(src.indexOf("youtube.com/embed/")!=-1){if(typeof playerId=="undefined"){playerId="youtubePlayer"+Object.keys(vars.youtubePlayers).length;elem.attr("id",playerId)}if(src.indexOf("enablejsapi=1")==-1){urlconn="&";if(src.indexOf("?")==-1){urlconn="?"}elem.attr("src",src+urlconn+"enablejsapi=1&version=3")}if(typeof vars.youtubePlayers[playerId]=="undefined"){vars.youtubePlayers[playerId]={};onYouTubeIframeAPIReady()}}if(src.indexOf("player.vimeo.com/video/")!=-1){if(typeof playerId=="undefined"){playerId="vimeoPlayer"+Object.keys(vars.vimeoPlayers).length;elem.attr("id",playerId)}if(src.indexOf("api=1")==-1){urlconn="&";if(src.indexOf("?")==-1){urlconn="?"}elem.attr("src",src+urlconn+"api=1&player_id="+playerId)}if(typeof vars.vimeoPlayers[playerId]=="undefined"){vars.vimeoPlayers[playerId]={}}}}};var youtubePlayerReady=function(e,playerId){if(jQuery("#"+playerId).length){if(typeof vars.youtubePlayers[playerId].playerObj.getPlayerState!="function"){}else{if(typeof vars.youtubePlayers[playerId].progress=="undefined"){vars.youtubePlayers[playerId].progress=0;vars.youtubePlayers[playerId].start=false;vars.youtubePlayers[playerId].complete=false;var videoData=vars.youtubePlayers[playerId].playerObj.getVideoData();vars.youtubePlayers[playerId].title=videoData.title;vars.youtubePlayers[playerId].duration=vars.youtubePlayers[playerId].playerObj.getDuration();if(!vars.youtubePlayers[playerId].start)youtubePlayerStateChange(e,playerId)}}}else{delete vars.youtubePlayers[playerId]}};var youtubePlayerStateChange=function(e,playerId){if(jQuery("#"+playerId).length){var label;if(vars.youtubePlayers[playerId].playerObj.getPlayerState()===0&&!vars.youtubePlayers[playerId].complete){label="Complete";vars.youtubePlayers[playerId].complete=true}if(vars.youtubePlayers[playerId].playerObj.getPlayerState()==1){vars.youtubePlayers[playerId].timer=setTimeout(function(){youtubePlayerStateChange(e,playerId)},1e3);if(!vars.youtubePlayers[playerId].start){label="Start";vars.youtubePlayers[playerId].start=true}else{var currentTime=vars.youtubePlayers[playerId].playerObj.getCurrentTime();if(Math.ceil(Math.ceil(currentTime/vars.youtubePlayers[playerId].duration*100)/10)-1>vars.youtubePlayers[playerId].progress){vars.youtubePlayers[playerId].progress=Math.ceil(Math.ceil(currentTime/vars.youtubePlayers[playerId].duration*100)/10)-1;if(vars.youtubePlayers[playerId].progress!=10){label=vars.youtubePlayers[playerId].progress*10+"%"}else{clearTimeout(vars.youtubePlayers[playerId].timer)}}}}if(vars.youtubePlayers[playerId].playerObj.getPlayerState()==3){vars.youtubePlayers[playerId].timer=setTimeout(function(){youtubePlayerStateChange(e,playerId)},1e3)}if(label){videoTrackingEvent(playerId,label,vars.youtubePlayers[playerId].title,vars.youtubePlayers[playerId].progress*10)}}else{delete vars.youtubePlayers[playerId]}};var vimeoReceiveMessage=function(e){if(/^https?:\/\/player.vimeo.com/.test(e.origin)){var data=JSON.parse(e.data);player=vars.vimeoPlayers[data.player_id];var label;switch(data.event){case"ready":player.progress=0;player.start=false;player.complete=false;vimeoSendMessage(data.player_id,e.origin,"addEventListener","play");vimeoSendMessage(data.player_id,e.origin,"addEventListener","finish");vimeoSendMessage(data.player_id,e.origin,"addEventListener","playProgress");break;case"play":if(!player.start){label="Start";player.start=true}break;case"playProgress":if(Math.ceil(Math.ceil(data.data.percent*100)/10)-1>player.progress){player.progress=Math.ceil(Math.ceil(data.data.percent*100)/10)-1;if(player.progress!=10){label=player.progress*10+"%"}}break;case"finish":if(!player.complete){label="Complete";player.complete=true}}if(label){videoTrackingEvent(data.player_id,label,"No title",player.progress*10)}}};var vimeoSendMessage=function(playerId,origin,action,value){var data={method:action};if(value){data.value=value}document.getElementById(playerId).contentWindow.postMessage(JSON.stringify(data),origin)};var videoTrackingEvent=function(playerId,label,title,value){ga("send",{hitType:"event",eventCategory:"Video",eventAction:label,eventLabel:title+" ("+jQuery("#"+playerId).attr("src").split("?")[0]+")",eventValue:value})};var onYouTubeIframeAPIReady=function(){if(vars.youTubeIframeAPIReady&&typeof YT!=="undefined"&&YT&&YT.Player){Object.keys(vars.youtubePlayers).forEach(function(playerId){if(typeof vars.youtubePlayers[playerId].playerObj=="undefined"){vars.youtubePlayers[playerId].playerObj=new YT.Player(playerId,{events:{onReady:function(e){lqx.youtubePlayerReady(e,playerId)},onStateChange:function(e){lqx.youtubePlayerStateChange(e,playerId)}}})}})}else{vars.youTubeIframeAPIReadyAttempts++;if(vars.youTubeIframeAPIReadyAttempts<120)setTimeout(function(){onYouTubeIframeAPIReady()},250)}};var initUserActive=function(){vars.userActive={active:true,timer:false,throttle:false,lastChangeTime:(new Date).getTime(),activeTime:0,inactiveTime:0};lqx.vars.window.on("orientationchange resize focusin",function(){userActive()});lqx.vars.document.on("mousedown mousemove mouseup wheel keydown keypress keyup touchstart touchmove touchend",function(){userActive()});lqx.vars.window.on("focusout",function(){userInactive()});var timer=setInterval(function(){if(vars.userActive.activeTime+vars.userActive.inactiveTime>=vars.userActive.maxTime)clearInterval(timer);else{if(vars.userActive.active){vars.userActive.activeTime+=(new Date).getTime()-vars.userActive.lastChangeTime}else{vars.userActive.inactiveTime+=(new Date).getTime()-vars.userActive.lastChangeTime}vars.userActive.lastChangeTime=(new Date).getTime()}},lqx.opts.userActive.refresh);lqx.userActive()};var userActive=function(){if(!vars.userActive.throttle){vars.userActive.throttle=true;setTimeout(function(){vars.userActive.throttle=false},lqx.opts.userActive.throttle);if(!vars.userActive.active){vars.userActive.active=true;vars.userActive.inactiveTime+=(new Date).getTime()-vars.userActive.lastChangeTime;vars.userActive.lastChangeTime=(new Date).getTime()}vars.userActive.active=true;clearTimeout(vars.userActive.timer);vars.userActive.timer=setTimeout(function(){userInactive()},lqx.opts.userActive.idleTime)}};var userInactive=function(){vars.userActive.active=false;clearTimeout(vars.userActive.timer);vars.userActive.activeTime+=(new Date).getTime()-vars.userActive.lastChangeTime;vars.userActive.lastChangeTime=(new Date).getTime()};return{init:init,gaReady:gaReady,onYouTubeIframeAPIReady:onYouTubeIframeAPIReady}}();lqx.analytics.init()}
